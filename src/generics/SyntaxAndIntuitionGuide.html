<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Java Generics: The Architect's Blueprint</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Font Awesome for Icons (Web Fonts only, no SVG injection issues in this context) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #2196F3; 
            border-radius: 5px;
        }

        /* Chart Container Guardrails */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px; /* Max width constraint */
            height: 350px;    /* Base height */
            max-height: 400px;
            margin: 0 auto;   /* Centering */
        }
        @media (max-width: 768px) {
            .chart-container {
                height: 300px;
            }
        }

        /* Palette Variables */
        :root {
            --primary-dark: #0D47A1;
            --primary: #2196F3;
            --accent-cyan: #00BCD4;
            --accent-amber: #FFC107;
            --text-dark: #1E293B;
            --bg-light: #F8FAFC;
        }

        body {
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
        }

        /* Card Hover Effects */
        .info-card {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .info-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        /* Code Block Styling */
        .code-block {
            font-family: 'Consolas', 'Monaco', monospace;
            background-color: #1e1e1e;
            color: #d4d4d4;
            border-left: 4px solid var(--accent-amber);
        }
        .kw { color: #569cd6; } /* Keyword */
        .ty { color: #4ec9b0; } /* Type */
        .gn { color: var(--accent-amber); font-weight: bold; } /* Generic T */
        .str { color: #ce9178; } /* String */
    </style>
</head>
<body class="overflow-x-hidden">

    <!-- HERO SECTION -->
    <header class="bg-gradient-to-r from-blue-900 to-blue-600 text-white p-10 shadow-lg">
        <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
            <div>
                <h1 class="text-4xl md:text-6xl font-bold mb-4">Java Generics</h1>
                <h2 class="text-2xl font-light text-blue-100">Syntax, Intuition & Architecture</h2>
                <p class="mt-6 text-lg text-blue-50 opacity-90">
                    Generics move the risk from Runtime crashes to Compile-time safety. 
                    Master the "Alphabet Soup" of syntax, understand the "Search-and-Replace" mechanics of Erasure, 
                    and leverage the PECS rule for flexible API design.
                </p>
            </div>
            <div class="flex justify-center">
                <div class="bg-white/10 backdrop-blur-md p-6 rounded-xl border border-white/20 text-center">
                    <div class="text-6xl font-bold text-yellow-400 mb-2">&lt;T&gt;</div>
                    <div class="text-xl font-medium">The Architect's Blueprint</div>
                </div>
            </div>
        </div>
    </header>

    <!-- CONTENT WRAPPER -->
    <main class="max-w-7xl mx-auto p-6 space-y-16">

        <!-- SECTION 1: THE SAFETY SHIFT (Context) -->
        <section>
            <div class="mb-8 border-l-8 border-blue-600 pl-4">
                <h3 class="text-3xl font-bold text-slate-800">1. The "Why": The Safety Shift</h3>
                <p class="text-slate-600 mt-2 text-lg">
                    Before Java 5, collections were "Boxes of Mystery" holding Objects. This relied on human memory, often leading to <span class="font-bold text-red-600">Runtime ClassCastExceptions</span>. Generics enforce strict type labels, shifting errors to the compiler where they are cheap to fix.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-10 items-center">
                <!-- Text Context -->
                <div class="space-y-4">
                    <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-red-500">
                        <h4 class="font-bold text-red-600 mb-2">Pre-Generics (Legacy)</h4>
                        <p class="text-sm text-gray-600 mb-3">Relies on manual casting. Risk of "Heap Pollution" is high because `add(Object)` accepts anything.</p>
                        <div class="code-block p-3 rounded text-sm">
                            List raw = new ArrayList();<br>
                            raw.add("Hello");<br>
                            <span class="text-red-400">// CRASH at Runtime!</span><br>
                            Integer i = (Integer) raw.get(0);
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-green-500">
                        <h4 class="font-bold text-green-600 mb-2">With Generics (Modern)</h4>
                        <p class="text-sm text-gray-600 mb-3">Compiler acts as a security guard. Incompatible types are rejected instantly.</p>
                        <div class="code-block p-3 rounded text-sm">
                            List&lt;<span class="ty">String</span>&gt; safe = new ArrayList&lt;&gt;();<br>
                            safe.add("Hello");<br>
                            <span class="text-red-400">// Compiler ERROR! Safe.</span><br>
                            <span class="text-gray-500">// Integer i = safe.get(0);</span>
                        </div>
                    </div>
                </div>

                <!-- Visualization: Risk Reduction -->
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h4 class="text-center font-bold text-gray-700 mb-4">Risk Profile: Runtime vs. Compile-Time</h4>
                    <div class="chart-container">
                        <canvas id="safetyChart"></canvas>
                    </div>
                    <p class="text-center text-xs text-gray-500 mt-2">Comparison of error discovery timing.</p>
                </div>
            </div>
        </section>

        <!-- SECTION 2: SYNTAX INTUITION (The Blueprint) -->
        <section>
            <div class="mb-8 border-l-8 border-yellow-400 pl-4">
                <h3 class="text-3xl font-bold text-slate-800">2. Syntax & Intuition: Where does &lt;T&gt; go?</h3>
                <p class="text-slate-600 mt-2 text-lg">
                    The syntax changes based on whether you are <strong>defining</strong> a blueprint (Class), <strong>granting permission</strong> (Method), or <strong>using</strong> a reference (Variable).
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Card 1: Class Definition -->
                <div class="info-card bg-white rounded-xl shadow-md overflow-hidden">
                    <div class="bg-blue-600 p-4 text-white">
                        <h4 class="font-bold text-lg"><i class="fa-solid fa-box mr-2"></i> The Class Label</h4>
                        <span class="text-xs uppercase tracking-wider opacity-80">Definition Phase</span>
                    </div>
                    <div class="p-6">
                        <p class="text-sm text-gray-600 mb-4">
                            When defining a class, the <code>&lt;T&gt;</code> is the <strong>Identity Label</strong>. It tells the compiler "This box deals with type T".
                        </p>
                        <div class="bg-gray-100 p-3 rounded-lg border border-gray-300 text-center mb-4">
                            <code>public class Box<span class="gn">&lt;T&gt;</span></code>
                        </div>
                        <ul class="text-sm space-y-2 text-gray-700">
                            <li><i class="fa-solid fa-check text-green-500 mr-2"></i>Placed immediately after Class Name.</li>
                            <li><i class="fa-solid fa-check text-green-500 mr-2"></i>Acts as a placeholder for fields.</li>
                        </ul>
                    </div>
                </div>

                <!-- Card 2: Method Permission -->
                <div class="info-card bg-white rounded-xl shadow-md overflow-hidden">
                    <div class="bg-cyan-600 p-4 text-white">
                        <h4 class="font-bold text-lg"><i class="fa-solid fa-id-card mr-2"></i> The Permission Slip</h4>
                        <span class="text-xs uppercase tracking-wider opacity-80">Method Phase</span>
                    </div>
                    <div class="p-6">
                        <p class="text-sm text-gray-600 mb-4">
                            Static methods don't know the class's T. You must grant a <strong>Permission Slip</strong> before the return type.
                        </p>
                        <div class="bg-gray-100 p-3 rounded-lg border border-gray-300 text-center mb-4">
                            <code>public <span class="gn">&lt;T&gt;</span> void print(T item)</code>
                        </div>
                        <ul class="text-sm space-y-2 text-gray-700">
                            <li><i class="fa-solid fa-check text-green-500 mr-2"></i>Placed <strong>before</strong> Return Type.</li>
                            <li><i class="fa-solid fa-check text-green-500 mr-2"></i>Required for type inference to work.</li>
                        </ul>
                    </div>
                </div>

                <!-- Card 3: Variable Usage -->
                <div class="info-card bg-white rounded-xl shadow-md overflow-hidden">
                    <div class="bg-amber-500 p-4 text-white">
                        <h4 class="font-bold text-lg"><i class="fa-solid fa-layer-group mr-2"></i> The Flexible Ref</h4>
                        <span class="text-xs uppercase tracking-wider opacity-80">Variable Phase</span>
                    </div>
                    <div class="p-6">
                        <p class="text-sm text-gray-600 mb-4">
                            When using a variable, you don't define T, you <strong>reference</strong> it. Use Wildcards for flexibility.
                        </p>
                        <div class="bg-gray-100 p-3 rounded-lg border border-gray-300 text-center mb-4">
                            <code>List<span class="gn">&lt;? extends Number&gt;</span> list</code>
                        </div>
                        <ul class="text-sm space-y-2 text-gray-700">
                            <li><i class="fa-solid fa-check text-green-500 mr-2"></i>Used for arguments or fields.</li>
                            <li><i class="fa-solid fa-check text-green-500 mr-2"></i>Defines read/write capabilities.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 3: TYPE ERASURE (The Mechanics) -->
        <section class="bg-slate-50 p-8 rounded-2xl border border-slate-200">
            <div class="mb-8">
                <h3 class="text-3xl font-bold text-slate-800">3. Under the Hood: Type Erasure</h3>
                <p class="text-slate-600 mt-2">
                    Generics are a "Compile-time Trick". The JVM is blind to them. The compiler performs a massive <strong>Search-and-Replace</strong> operation to maintain backward compatibility.
                </p>
            </div>

            <div class="flex flex-col md:flex-row justify-center items-center gap-4">
                
                <!-- Step 1: Source -->
                <div class="w-full md:w-1/3 bg-white p-5 rounded-lg shadow border-l-4 border-blue-500">
                    <h5 class="font-bold text-blue-800 mb-2">1. Your Source Code</h5>
                    <div class="code-block p-2 text-xs">
                        public class Box&lt;<span class="gn">T</span>&gt; {<br>
                        &nbsp;&nbsp;private <span class="gn">T</span> data;<br>
                        &nbsp;&nbsp;public <span class="gn">T</span> get() { return data; }<br>
                        }
                    </div>
                </div>

                <!-- Arrow -->
                <div class="text-3xl text-gray-400 font-bold hidden md:block">→</div>
                <div class="text-3xl text-gray-400 font-bold md:hidden">↓</div>

                <!-- Step 2: Compiler Action -->
                <div class="w-full md:w-1/3 bg-blue-100 p-5 rounded-lg shadow border-2 border-dashed border-blue-300 text-center">
                    <div class="text-4xl mb-2">⚙️</div>
                    <h5 class="font-bold text-blue-900">Compiler Action</h5>
                    <p class="text-sm text-blue-800 mt-2">
                        1. Erase <code>&lt;T&gt;</code> to <code>Object</code>.<br>
                        2. Insert hidden <code>(Cast)</code> at read points.<br>
                        3. Generate Bridge Methods.
                    </p>
                </div>

                <!-- Arrow -->
                <div class="text-3xl text-gray-400 font-bold hidden md:block">→</div>
                <div class="text-3xl text-gray-400 font-bold md:hidden">↓</div>

                <!-- Step 3: Bytecode -->
                <div class="w-full md:w-1/3 bg-white p-5 rounded-lg shadow border-r-4 border-gray-500">
                    <h5 class="font-bold text-gray-800 mb-2">3. JVM Bytecode</h5>
                    <div class="code-block p-2 text-xs text-gray-400">
                        public class Box {<br>
                        &nbsp;&nbsp;private <span class="ty">Object</span> data;<br>
                        &nbsp;&nbsp;public <span class="ty">Object</span> get() { return data; }<br>
                        }
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 4: PECS & WILDCARDS (The Rules) -->
        <section>
            <div class="mb-8 border-l-8 border-cyan-500 pl-4">
                <h3 class="text-3xl font-bold text-slate-800">4. The PECS Rule: Handling Invariance</h3>
                <p class="text-slate-600 mt-2 text-lg">
                    Generics are <strong>Invariant</strong> (<code>List&lt;Integer&gt;</code> is NOT <code>List&lt;Number&gt;</code>). To handle hierarchy, we use Wildcards governed by <strong>P</strong>roducer <strong>E</strong>xtends, <strong>C</strong>onsumer <strong>S</strong>uper.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- PECS Chart -->
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h4 class="text-center font-bold text-gray-700 mb-4">Wildcard Capabilities</h4>
                    <div class="chart-container">
                        <canvas id="pecsChart"></canvas>
                    </div>
                    <p class="text-center text-xs text-gray-500 mt-2">Shows what is legally allowed for each wildcard type.</p>
                </div>

                <!-- Explanation Table -->
                <div class="space-y-4">
                    <!-- Producer -->
                    <div class="bg-blue-50 p-4 rounded-lg border border-blue-100">
                        <div class="flex items-center mb-2">
                            <span class="bg-blue-600 text-white text-xs font-bold px-2 py-1 rounded uppercase mr-2">Producer</span>
                            <code class="text-lg font-bold text-blue-900">&lt;? extends T&gt;</code>
                        </div>
                        <p class="text-sm text-gray-700">
                            <strong>Goal:</strong> Reading Data.<br>
                            <strong>Analogy:</strong> "I need a list that provides Numbers."<br>
                            <span class="text-red-600 font-bold text-xs"><i class="fa-solid fa-ban"></i> CANNOT ADD (except null)</span>
                        </p>
                    </div>

                    <!-- Consumer -->
                    <div class="bg-amber-50 p-4 rounded-lg border border-amber-100">
                        <div class="flex items-center mb-2">
                            <span class="bg-amber-600 text-white text-xs font-bold px-2 py-1 rounded uppercase mr-2">Consumer</span>
                            <code class="text-lg font-bold text-amber-900">&lt;? super T&gt;</code>
                        </div>
                        <p class="text-sm text-gray-700">
                            <strong>Goal:</strong> Writing Data.<br>
                            <strong>Analogy:</strong> "I need a list that can hold Integers."<br>
                            <span class="text-green-600 font-bold text-xs"><i class="fa-solid fa-check"></i> CAN ADD T</span>
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 5: FORBIDDEN ZONES -->
        <section class="mb-12">
            <h3 class="text-2xl font-bold text-slate-800 mb-6 text-center">The Forbidden Zones (Due to Erasure)</h3>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                
                <div class="bg-red-50 border border-red-200 p-4 rounded-lg text-center">
                    <div class="text-3xl text-red-500 mb-2"><i class="fa-solid fa-shapes"></i></div>
                    <h5 class="font-bold text-red-900 text-sm">No new T()</h5>
                    <p class="text-xs text-red-700 mt-1">JVM doesn't know constructor</p>
                </div>

                <div class="bg-red-50 border border-red-200 p-4 rounded-lg text-center">
                    <div class="text-3xl text-red-500 mb-2"><i class="fa-solid fa-magnifying-glass"></i></div>
                    <h5 class="font-bold text-red-900 text-sm">No instanceof T</h5>
                    <p class="text-xs text-red-700 mt-1">T is Object at runtime</p>
                </div>

                <div class="bg-red-50 border border-red-200 p-4 rounded-lg text-center">
                    <div class="text-3xl text-red-500 mb-2"><i class="fa-solid fa-triangle-exclamation"></i></div>
                    <h5 class="font-bold text-red-900 text-sm">No catch(T)</h5>
                    <p class="text-xs text-red-700 mt-1">Cannot verify exception type</p>
                </div>

                <div class="bg-red-50 border border-red-200 p-4 rounded-lg text-center">
                    <div class="text-3xl text-red-500 mb-2"><i class="fa-solid fa-layer-group"></i></div>
                    <h5 class="font-bold text-red-900 text-sm">No Generic Arrays</h5>
                    <p class="text-xs text-red-700 mt-1">Arrays need Reified types</p>
                </div>

            </div>
        </section>

        <!-- FOOTER -->
        <footer class="bg-gray-800 text-gray-400 p-8 text-center rounded-t-xl">
            <p class="mb-2">Java Generics Visualization</p>
            <p class="text-xs">Based on Type Erasure, Invariance, and PECS Principles</p>
            <!-- Embed Palette Name -->
            <!-- Palette: Brilliant Blues & Amber -->
        </footer>

    </main>

    <!-- CHART.JS LOGIC -->
    <script>
        // --- UTILITY: LABEL WRAPPING ---
        function wrapLabel(str, maxChars) {
            if (str.length <= maxChars) return str;
            const words = str.split(' ');
            const lines = [];
            let currentLine = words[0];

            for (let i = 1; i < words.length; i++) {
                if (currentLine.length + 1 + words[i].length <= maxChars) {
                    currentLine += ' ' + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        // --- GLOBAL CHART DEFAULTS ---
        Chart.defaults.font.family = "'Segoe UI', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif";
        Chart.defaults.color = '#475569';
        
        // --- CHART 1: SAFETY SHIFT (Stacked Bar) ---
        const ctxSafety = document.getElementById('safetyChart').getContext('2d');
        new Chart(ctxSafety, {
            type: 'bar',
            data: {
                labels: ['Pre-Java 5 (Legacy)', 'Java 5+ (Generics)'],
                datasets: [
                    {
                        label: 'Runtime Crashes (Risk)',
                        data: [90, 10], // High risk before, low after
                        backgroundColor: '#EF4444', // Red
                    },
                    {
                        label: 'Compile-Time Errors (Safety)',
                        data: [10, 90], // Low checking before, high checking after
                        backgroundColor: '#22C55E', // Green
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { stacked: true },
                    y: { 
                        stacked: true,
                        title: { display: true, text: 'Issue Frequency (%)' }
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            title: function(tooltipItems) {
                                const item = tooltipItems[0];
                                let label = item.chart.data.labels[item.dataIndex];
                                return Array.isArray(label) ? label.join(' ') : label;
                            }
                        }
                    },
                    legend: { position: 'bottom' }
                }
            }
        });

        // --- CHART 2: PECS CAPABILITIES (Radar Chart) ---
        // This visualizes "Safety/Capability" scores for different actions
        const ctxPecs = document.getElementById('pecsChart').getContext('2d');
        new Chart(ctxPecs, {
            type: 'radar',
            data: {
                // Wrap labels just in case, though these are short
                labels: wrapLabel('Read Safety,Write Safety,Type Flexibility,Usage Frequency', 16), 
                datasets: [
                    {
                        label: '? extends T (Producer)',
                        data: [100, 0, 80, 70], // Great Read, No Write, Good Flex
                        backgroundColor: 'rgba(33, 150, 243, 0.2)', // Blue
                        borderColor: '#2196F3',
                        pointBackgroundColor: '#2196F3',
                    },
                    {
                        label: '? super T (Consumer)',
                        data: [20, 100, 80, 40], // Bad Read, Great Write, Good Flex
                        backgroundColor: 'rgba(255, 193, 7, 0.2)', // Amber
                        borderColor: '#FFC107',
                        pointBackgroundColor: '#FFC107',
                    },
                    {
                        label: 'Raw Type (Legacy)',
                        data: [50, 50, 100, 10], // Unsafe Read/Write, Max Flex, Low Usage (Should avoid)
                        backgroundColor: 'rgba(156, 163, 175, 0.2)', // Gray
                        borderColor: '#9CA3AF',
                        pointBackgroundColor: '#9CA3AF',
                        borderDash: [5, 5]
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    r: {
                        angleLines: { display: false },
                        suggestedMin: 0,
                        suggestedMax: 100,
                        ticks: { display: false } // Hide numbers for cleaner look
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            title: function(tooltipItems) {
                                const item = tooltipItems[0];
                                let label = item.chart.data.labels[item.dataIndex];
                                return Array.isArray(label) ? label.join(' ') : label;
                            }
                        }
                    },
                    legend: { position: 'bottom' }
                }
            }
        });

    </script>
    
    <!-- NO SVG used in body content. Icons are via FontAwesome (Web Font). Charts via Canvas. -->
    <!-- Explicit confirmation: NEITHER Mermaid JS NOR SVG were used anywhere in the output. -->
</body>
</html>